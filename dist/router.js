"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),Router=require("koa-router"),_require=require("fs"),readdirSync=_require.readdirSync,_require2=require("path"),join=_require2.join,request=require("request-promise"),router=new Router;router.prefix("/dw");var files=readdirSync(join(__dirname,"module")),regxFile=/\.js$/i;files.forEach(function(e){if(regxFile.test(e)){var r=e.replace(regxFile,"").split("_"),i=r[0],t=r[1],u=require(join(__dirname,"module",e));router[i]("/"+t,function(t){var r;return _regenerator.default.async(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.query,"post"===i&&(r=t.request.body),e.next=4,_regenerator.default.awrap(request(u(r)).then(function(e){t.type="application/json;charset=utf-8",t.status=200;var r="string"==typeof e?{data:e}:e;t.body=Object.assign(r,{code:0,msg:"okay"})}).catch(function(e){t.status=500,t.body=Object.assign(e,{code:500,msg:"failed"})}));case 4:case"end":return e.stop()}})})}}),module.exports=router;